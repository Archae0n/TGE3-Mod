tratr_friend_unlocked_effect = {
	add_modifier = { modifier = tratr_est_friend_unlocked days = -1 }
	every_country = {
		limit = {
			has_opinion_modifier = { 
				who = root
				modifier = opinion_new_contact
			}
		}
		remove_opinion_modifier = { 
			who = root
			modifier = opinion_new_contact
		}
	}
}

tratr_malice_unlocked_effect = {
	set_global_flag = est_malice_adopt_picked_flag
	add_modifier = { modifier = tratr_est_malice_unlocked days = -1 }
	every_country = {
		limit = {
			has_opinion_modifier = { 
				modifier = opinion_insult
				who = root
			}
			Not = {
				has_modifier = mod_est_malice_adopt
			}
		}
		add_modifier = {
			modifier = "mod_est_malice_adopt"
			days = -1
		}
	}
}
	
tratr_found_unlocked_effect = {
	hidden_effect = {
		add_modifier = { modifier = tratr_found_unlocked days = -1 }
		every_owned_planet = {
			limit = {
				est_is_core_world = yes
			}
			add_modifier = {
				modifier = mod_est_foundation_adopt days = -1
			}
		}
		set_country_flag = est_uses_foundation_traditions_flag
		set_global_flag = flag_est_foundation_adoption_picked
	}
}

tratr_confe_unlocked_effect = {
	hidden_effect = {
		add_modifier = { modifier = tratr_confe_unlocked days = -1 }
		set_country_flag = est_uses_confederacy_traditions_flag
		every_owned_planet = {
			limit = {
				est_is_core_world = yes
			}
			add_modifier = {
				modifier = mod_est_confederacy_adopt days = -1
			}
			set_global_flag = flag_est_confederacy_adopt_picked
		}
	}
}

tratr_subminds_unlocked_effect = {
	hidden_effect = {
		add_modifier = { modifier = tratr_subminds_unlocked days = -1 }
	}
}

tratr_chiva_unlocked_effect = {
	hidden_effect = {
		every_owned_leader = {
			limit = {
				Not = {
					has_trait =	leader_trait_admiral_est_chivalry
					has_trait =	leader_trait_general_est_chivalry
					has_trait =	leader_trait_governor_est_chivalry
					has_trait =	leader_trait_scientist_est_chivalry
					has_trait =	leader_trait_ruler_est_chivalry
				}
			}
			if = {
				limit = { leader_class = admiral }
				add_trait = leader_trait_admiral_est_chivalry
				add_ruler_trait = leader_trait_ruler_est_chivalry
			}
			if = {
				limit = { leader_class = general }
				add_trait = leader_trait_general_est_chivalry
				add_ruler_trait = leader_trait_ruler_est_chivalry
			}
			if = {
				limit = { leader_class = governor }
				add_trait = leader_trait_governor_est_chivalry
				add_ruler_trait = leader_trait_ruler_est_chivalry
			}
			if = {
				limit = { leader_class = scientist }
				add_trait = leader_trait_scientist_est_chivalry
				add_ruler_trait = leader_trait_ruler_est_chivalry
			}
			if = {
				limit = { leader_class = ruler }
				add_trait = leader_trait_ruler_est_chivalry
			}
		}
		every_pool_leader = {
			limit = {
				Not = {
					has_trait = leader_trait_admiral_est_chivalry
					has_trait = leader_trait_general_est_chivalry
					has_trait = leader_trait_governor_est_chivalry
					has_trait = leader_trait_scientist_est_chivalry
					has_trait = leader_trait_ruler_est_chivalry
				}
			}
			if = {
				limit = { leader_class = admiral }
				add_trait = leader_trait_admiral_est_chivalry
				add_ruler_trait = leader_trait_ruler_est_chivalry
			}
			if = {
				limit = { leader_class = general }
				add_trait = leader_trait_general_est_chivalry
				add_ruler_trait = leader_trait_ruler_est_chivalry
			}
			if = {
				limit = { leader_class = governor }
				add_trait = leader_trait_governor_est_chivalry
				add_ruler_trait = leader_trait_ruler_est_chivalry
			}
			if = {
				limit = { leader_class = scientist }
				add_trait = leader_trait_scientist_est_chivalry
				add_ruler_trait = leader_trait_ruler_est_chivalry
			}
			if = {
				limit = { leader_class = ruler }
				add_trait = leader_trait_ruler_est_chivalry
			}
		}
	}
}

tratr_isolation_unlocked_effect = {
	hidden_effect = {
		add_modifier = { modifier = tratr_isolation_unlocked days = -1 }
		if = {
			limit = { is_at_war = no }
			add_modifier = { modifier = mod_est_isolation_finish days = -1 }
		}
	}
}

tratr_isolationgc_unlocked_effect = {
	hidden_effect = {
		add_modifier = { modifier = tratr_isolation_unlocked days = -1 }
		if = {
			limit = { is_at_war = no }
			add_modifier = { modifier = mod_est_isolation_finish_GC days = -1 }
		}
	}
}

tratr_proys_unlocked_effect = {
	hidden_effect = {
		add_modifier = { modifier = tratr_proys_unlocked days = -1 }
		every_owned_planet = {
			if = {
				limit = {
					Not = {
						any_owned_pop = {
							Not = {
								and = {
									pop_has_ethic = ethic_authoritarian
									owner ={
										or = {
											has_ethic = ethic_authoritarian
											has_ethic = ethic_fanatic_authoritarian
										}
									}
								}
								and = {
									pop_has_ethic = ethic_egalitarian
									owner ={
										or = {
											has_ethic = ethic_egalitarian
											has_ethic = ethic_fanatic_egalitarian
										}
									}
								}
								and = {
									pop_has_ethic = ethic_xenophobe
									owner ={
										or = {
											has_ethic = ethic_xenophobe
											has_ethic = ethic_fanatic_xenophobe
										}
									}
								}
								and = {
									pop_has_ethic = ethic_xenophile
									owner ={
									or = {
											has_ethic = ethic_xenophile
											has_ethic = ethic_fanatic_xenophile
										}
									}
								}
								and = {
									pop_has_ethic = ethic_militarist
									owner ={
										or = {
											has_ethic = ethic_militarist
											has_ethic = ethic_fanatic_militarist
										}
									}
								}
								and = {
									pop_has_ethic = ethic_pacifist
									owner ={
										or = {
											has_ethic = ethic_pacifist
											has_ethic = ethic_fanatic_pacifist
										}
									}
								}
								and = {
									pop_has_ethic = ethic_materialist
									owner ={
										or = {
											has_ethic = ethic_materialist
											has_ethic = ethic_fanatic_materialist
										}
									}
								}
								and = {
									pop_has_ethic = ethic_spiritualist
									owner ={
										or = {
											has_ethic = ethic_spiritualist
											has_ethic = ethic_fanatic_spiritualist
										}
									}
								}
							}
							is_enslaved = no
						}
					}
				}
				add_modifier = {
					modifier = "mod_est_prosyletism_adopt"
					days = -1
				}
			}
		}
		set_global_flag = est_proselytism_adopt_picked_flag
	}
}

tratr_aesth_unlocked_effect = {
	hidden_effect = {
		add_modifier = { modifier = tratr_aesth_unlocked days = -1 }
		every_owned_planet = {
			limit = {
				Or = {
					has_building = building_autochthon_monument
					has_building = building_heritage_site
					has_building = building_hypercomms_forum
					has_building = building_autocurating_vault				
				}
			}
			add_modifier = {
				modifier = mod_est_aesthetics_adopt
				days = -1
			}
		}	
	}
}

tratr_aesthspirit_unlocked_effect = {
	hidden_effect = {
		add_modifier = { modifier = tratr_aesthspirit_unlocked days = -1 }
		every_owned_planet = {
			limit = {
				Or = {
					has_building = building_temple
					has_building = building_holotemple
					has_building = building_sacred_nexus
					has_building = building_citadel_of_faith		
				}
			}
			add_modifier = {
				modifier = mod_est_aesthetics_adopt
				days = -1
			}
		}
	}
}

tratr_justice_unlocked_effect = {
	hidden_effect = {
		add_modifier = { modifier = tratr_justice_unlocked days = -1 }
	}
	if = {
		limit = {
			has_resource = {
				type =  influence 
				amount > 749
			}
		}
		if = {
			limit = {
				has_resource = {
					type =  influence 
					amount > 999
				}
			}
			add_modifier = {
				modifier = "mod_est_justice_finish_2"
				days = -1
			}
		}
		else = {
			add_modifier = {
				modifier = "mod_est_justice_finish_1"
				days = -1
			}
		}
	}
	set_global_flag = est_justice_finish_picked_flag
}

tratr_dest_unlocked_effect = {
	hidden_effect = {
		add_modifier = { modifier = tratr_dest_unlocked days = -1 }
		every_country = {
			limit = {
				is_at_war_with = root
				Not = {
					has_modifier = mod_est_destruction_finish
				}
			}
			add_modifier = {
				modifier = "mod_est_destruction_finish"
				days = -1
			}				
		}
		set_global_flag = est_destruction_finish_picked_flag
	}
}

tratr_fury_unlocked_effect = {
	hidden_effect = {
		set_country_flag = flag_est_fury_max_level_0
		add_modifier = { modifier = mod_est_fury_adopt_0 days = -1 }
		country_event = { id =  est_liberty.6 }
	}
}

tratr_cooper_unlocked_effect = {
	hidden_effect = {
		add_modifier = { modifier = tratr_cooper_unlocked days = -1 }
		every_owned_planet = {
			if = {
				limit = {
					num_pops > 23
				}
				add_modifier = {
					modifier = "mod_est_cooperativity_adopt_3"
					days = -1
				}
			}
			else = {
				if = {
					limit = {
						num_pops > 19
					}
					add_modifier = {
						modifier = "mod_est_cooperativity_adopt_2"
						days = -1
					}
				}
				else = {
					if = {
						limit = {
							num_pops > 15
						}
						add_modifier = {
							modifier = "mod_est_cooperativity_adopt_1"
							days = -1
						}
					}
				}	
			}
		}
		set_global_flag = est_cooperativity_adopt_picked_flag
	}
}

#Archivist doesnt use this

tratr_aca_unlocked_effect = {
	hidden_effect = {
		add_modifier = { modifier = tratr_aca_unlocked days = -1 }
		every_owned_leader = {
			owner = {
				country_event = {
					id = est_academy.4
					scopes = {
						from = prev
					}
				}
			}
		}
	}
}

tratr_milit_unlocked_effect = {
	hidden_effect = {
		add_modifier = { modifier = tratr_milit_unlocked days = -1 }
		if = {
			limit = {
				Not = {
					used_naval_capacity_percent < 1.0
				}
			}
			add_modifier = {
				modifier = "mod_est_militarism_adopt"
			}
		}
		set_global_flag = est_militarism_adopt_picked_flag
	}
}

tratr_might_unlocked_effect = {
	hidden_effect = {
		add_modifier = { modifier = tratr_might_unlocked days = -1 }
		if = {
			limit = {
				Not = {
					used_naval_capacity_percent < 1.0
				}
			}
			add_modifier = {
				modifier = "mod_est_might_adopt"
			}
		}
		set_global_flag = est_might_adopt_picked_flag
	}
}

tratr_pirspec_unlocked_effect = {
	hidden_effect = {
		add_modifier = { modifier = tratr_pirspec_unlocked days = -1 }
		if = {
			limit = { is_at_war = yes }
			add_modifier = { modifier = mod_est_piracy_adopt_special days = -1 }
		}
	}
}

tratr_pirspecgc_unlocked_effect = {
	hidden_effect = {
		add_modifier = { modifier = tratr_pirspec_unlocked days = -1 }
		if = {
			limit = { is_at_war = yes }
			add_modifier = { modifier = mod_est_piracy_adopt_special_GC days = -1 }
		}
	}
}

tratr_myst_unlocked_effect = {
	hidden_effect = {
		add_modifier = { modifier = tratr_myst_unlocked days = -1 }
		every_neighbor_country = {
			limit = {
				Not = {
					is_in_federation_with = prev
					is_overlord_to = prev
					prev = { is_overlord_to = prev }
				}
			}
			set_timed_country_flag = {
				flag = est_mysticism_adopt_flag
				days = 1
			}
			if = {
				limit = { has_modifier = mod_est_mysticism_adopt }
				add_modifier = { modifier = "mod_est_mysticism_adopt" days = -1 }
			}
		}
		set_global_flag = est_mysticism_adopt_picked_flag
	}
}